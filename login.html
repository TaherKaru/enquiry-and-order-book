<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Goodluck Stores - Auth</title>
<style>
body {
  font-family: 'Segoe UI', Tahoma, sans-serif;
  background: linear-gradient(135deg,#f0f4f8,#d9eaf7);
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  margin:0;
}
.auth-container {
  background:white;
  padding:30px 40px;
  border-radius:15px;
  box-shadow:0 8px 20px rgba(0,0,0,0.2);
  width:100%;
  max-width:400px;
}
.auth-container h2 {
  text-align:center;
  margin-bottom:20px;
  color:#00796B;
}
.auth-container label { display:block; margin-top:12px; font-weight:bold; }
.auth-container input { width:100%; padding:10px; margin-top:6px; border:1px solid #ccc; border-radius:8px; font-size:14px; }
.auth-container button { margin-top:20px; width:100%; padding:12px; background:#00796B; color:white; font-weight:bold; border:none; border-radius:8px; cursor:pointer; font-size:16px; transition:0.3s; }
.auth-container button:hover { background:#004d40; }
.auth-container .error-msg { color:red; margin-top:10px; text-align:center; display:none; }
.auth-container .switch-btn { background:#FF9800; margin-top:10px; }
.auth-container .forgot-btn { background:#0288D1; margin-top:5px; }
</style>
</head>
<body>

<div class="auth-container">
  <h2 id="authTitle">Sign In</h2>

  <form id="authForm">
    <label>Email</label>
    <input type="email" id="email" required placeholder="Enter email">
    <label>Password</label>
    <input type="password" id="password" required placeholder="Enter password">
    <button type="submit" id="authBtn">Sign In</button>
  </form>

  <button class="switch-btn" id="switchBtn">Create Account</button>
  <button class="forgot-btn" id="forgotBtn">Forgot Password?</button>
  <div class="error-msg" id="errorMsg"></div>
  <div class="error-msg" id="successMsg" style="color:green;"></div>
</div>

<script type="module">
  // 1️⃣ Import Firebase modular SDK
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";

  // 2️⃣ Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyAdx4Q8LPLwTxdR6pC_BJ7db_ZKXx71ayc",
    authDomain: "goodluck-stores.firebaseapp.com",
    projectId: "goodluck-stores",
    storageBucket: "goodluck-stores.firebasestorage.app",
    messagingSenderId: "1013775003230",
    appId: "1:1013775003230:web:77f5f643431bb69549cecf",
    measurementId: "G-KSRTDV1BLQ"
  };

  // 3️⃣ Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  // 4️⃣ DOM elements
  let isSignUp = false;
  const authForm = document.getElementById("authForm");
  const authTitle = document.getElementById("authTitle");
  const authBtn = document.getElementById("authBtn");
  const switchBtn = document.getElementById("switchBtn");
  const forgotBtn = document.getElementById("forgotBtn");
  const errorMsg = document.getElementById("errorMsg");
  const successMsg = document.getElementById("successMsg");

  // 5️⃣ Toggle Sign In / Sign Up
  switchBtn.addEventListener("click", () => {
    isSignUp = !isSignUp;
    authTitle.textContent = isSignUp ? "Create Account" : "Sign In";
    authBtn.textContent = isSignUp ? "Sign Up" : "Sign In";
    switchBtn.textContent = isSignUp ? "Already have an account?" : "Create Account";
    errorMsg.style.display = "none";
    successMsg.style.display = "none";
  });

  // 6️⃣ Forgot password
  forgotBtn.addEventListener("click", () => {
    const email = document.getElementById("email").value;
    if(!email) {
      errorMsg.style.display = "block";
      errorMsg.textContent = "Please enter your email to reset password.";
      return;
    }
    sendPasswordResetEmail(auth, email)
      .then(() => {
        successMsg.style.display = "block";
        successMsg.textContent = "Password reset email sent!";
        errorMsg.style.display = "none";
      })
      .catch(err => {
        errorMsg.style.display = "block";
        errorMsg.textContent = err.message;
        successMsg.style.display = "none";
        console.error(err);
      });
  });

  // 7️⃣ Handle Sign In / Sign Up form submission
  authForm.addEventListener("submit", (e) => {
    e.preventDefault();
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;

    if(isSignUp){
      // Sign Up
      createUserWithEmailAndPassword(auth, email, password)
        .then((userCredential) => {
          console.log("Account created:", userCredential.user);
          localStorage.setItem("loggedInUser", email);
          window.location.href = "index.html"; // redirect after signup
        })
        .catch(err => {
          errorMsg.style.display = "block";
          errorMsg.textContent = err.message;
          successMsg.style.display = "none";
          console.error(err);
        });
    } else {
      // Sign In
      signInWithEmailAndPassword(auth, email, password)
        .then((userCredential) => {
          console.log("Signed in:", userCredential.user);
          localStorage.setItem("loggedInUser", email);
          window.location.href = "index.html"; // redirect after signin
        })
        .catch(err => {
          errorMsg.style.display = "block";
          errorMsg.textContent = err.message;
          successMsg.style.display = "none";
          console.error(err);
        });
    }
  });
</script>

</body>
</html>
